### 完美的求和

#### Python

为了完美的解决人工计算主播的业绩时所可能产生的错误，我写了一个 Python 程序来专门计算这一操作，其代码如下：

import pandas as pd

# 请求用户输入文件名
filename = input("请输入文件名:")
filepath = "D:\\Users\\Ran\\Downloads\\" + filename + ".xlsx"

# 读取 Excel 文件中的 "小时级" sheet，使用 openpyxl 作为引擎
df = pd.read_excel(filepath, sheet_name='小时级', engine='openpyxl')

# 清理 '成交金额' 列，移除非数字字符
df['成交金额'] = df['成交金额'].replace({'¥': '', ',': ''}, regex=True).astype(float)

# 转换 '时间' 列为时间格式，并获取时间部分（不含日期）
df['时间'] = pd.to_datetime(df['时间']).dt.time

# 定义时间列表
time_A = [pd.to_datetime(t, format='%H:%M').time() for t in ['08:00', '09:00', '10:00', '11:00', '14:00', '15:00']]
time_B = [pd.to_datetime(t, format='%H:%M').time() for t in ['12:00', '13:00']]
time_C = [pd.to_datetime(t, format='%H:%M').time() for t in ['16:00', '17:00', '18:00']]

# 根据 '时间' 列找到对应的行并求和 '成交金额' 列对应的值
df_A = df[df['时间'].isin(time_A)]['成交金额']
df_B = df[df['时间'].isin(time_B)]['成交金额']
df_C = df[df['时间'].isin(time_C)]['成交金额']

sum_A = df_A.sum()
sum_B = df_B.sum()
sum_C = df_C.sum()

print("A主播总成交金额：", sum_A, "计算公式：", '+'.join(map(str, df_A.values)))
print("B主播总成交金额：", sum_B, "计算公式：", '+'.join(map(str, df_B.values)))
print("C主播总成交金额：", sum_C, "计算公式：", '+'.join(map(str, df_C.values)))

#### 用法

1.  将上述Python代码保存为.py文件后，将其和从抖音官方下载的「每分钟每小时成交详情表」置于同一目录下![](https://cdn.nlark.com/yuque/0/2023/png/34333118/1684834535359-ddc6d8ab-3a53-4f0f-ace3-4ec740f4aabe.png)

2.  在 Windows 命令提示符中输入 cd 上述目录 (在我这里是 cd /d D:\Users\Ran\Downloads) 以进入该目录![](https://cdn.nlark.com/yuque/0/2023/png/34333118/1684835178976-8640b7ae-4b61-40c2-b136-59fe9ee51584.png)
3.  然后键入 python 前述.py文件 (在我这里是 python excel_sum.py) 以运行该 Python 文件![](https://cdn.nlark.com/yuque/0/2023/png/34333118/1684835352863-e82bc4ef-1fa3-4b63-89f6-6aeb9f378d1f.png)
4.  之后上述 Python 程序将被启动，并要求你输入对应的表格名称![](https://cdn.nlark.com/yuque/0/2023/png/34333118/1684835387966-4f8a47a7-6841-430c-9c7f-32319a048f9d.png)
5.  输入对应的表格名称 (在我这里是 18早)![](https://cdn.nlark.com/yuque/0/2023/png/34333118/1684835476386-46298194-28d1-4ab2-b48c-489ff7e8f6c2.png)

#### 计算结果

##### 5月18日

输入完成后回车，就能得到结果

![](https://cdn.nlark.com/yuque/0/2023/png/34333118/1684835513173-8f14f5f3-047e-46ad-825e-1bbb427fd44a.png)

该18早的表格即为「5月18日的成交详情表」，可以看到计算公式和最终数值都是正确的

-   并且由于是 Python 程序，该计算结果从今往后也将保证 100% 正确

![](https://cdn.nlark.com/yuque/0/2023/png/34333118/1684835772895-6394d4c9-20a8-43f6-85e0-f3724122dc83.png)

##### 5月19日

同样 100% 准确。

![](https://cdn.nlark.com/yuque/0/2023/png/34333118/1684837344224-7620eb29-1729-40db-abe8-69c057b9c1fd.png)

![](https://cdn.nlark.com/yuque/0/2023/png/34333118/1684837289523-699f6f10-cd13-4363-8962-663d8f9ae204.png)

小贴士：上述计算结果中的「5459.4400000000005」数值是计算结果的一种常见现象，这是由于浮点数在计算机中表示时产生的精度误差。

计算机在进行浮点数运算时，会遇到一些因为二进制表示导致的精度问题。简单来说，某些十进制的小数，转换为二进制表示后是无限循环小数，这就导致了在计算机进行浮点数运算时，会有一些微小的误差。这种误差在大多数情况下可以忽略。

##### 5月20日

同样 100% 准确。

![](https://cdn.nlark.com/yuque/0/2023/png/34333118/1684837796774-fbe6dcf3-d5aa-4bf9-adfc-3d24acb1719a.png)

![](https://cdn.nlark.com/yuque/0/2023/png/34333118/1684837935145-04fd6f22-b160-4b46-ba89-19da48cf44e1.png)

##### 5月21日

同样 100% 准确。

![](https://cdn.nlark.com/yuque/0/2023/png/34333118/1684846004366-e63923a9-3b8f-48f4-a06f-62e7ec6d7efc.png)

![](https://cdn.nlark.com/yuque/0/2023/png/34333118/1684846053531-d2cbd2fa-0d57-4373-a471-d538221d70c9.png)

##### 5月22日

同样 100% 准确。

![](https://cdn.nlark.com/yuque/0/2023/png/34333118/1684846106960-bf0646f2-772c-4da3-960d-3dfee86234e8.png)

![](https://cdn.nlark.com/yuque/0/2023/png/34333118/1684846149134-4c735e0c-c802-46d9-9b41-e0e5654e4a2a.png)

#### 解决了

1.  人工计算可能导致的误差

1.  由于该操作的在需要保证高准确度的情况下，用人工计算的工作量和复杂度是较高的，所以较容易出现计算错误
2.  实际上在 4月22日，就出现过人工加总时算错的问题，如下图一和二，该计算流程引入了 Python 来计算将从流程层面避免再出现这类错误

![](https://cdn.nlark.com/yuque/0/2023/jpeg/34333118/1684848709355-53466f76-2123-4bdb-8e45-5ff0e0dfa7c0.jpeg)

![](https://cdn.nlark.com/yuque/0/2023/jpeg/34333118/1684848717412-5997255e-771f-4803-bc01-7ddaa37474df.jpeg)

2.  使得「日常直播数据复盘表」(如下图) 中的所有数据 (除了E列，下同)，均完全使用抖音官方的数据源，让「日常直播数据复盘表」中所有数据均能保证 100% 正确。

1.  并且由于我良好的数据更新流程，每次更新时所有数据都将得到更新：比如说5月1日某场直播当日退货率为10% (假设为10%)，那么我在5月30日更新当天的直播数据时，5月1日的那场直播的数据均会同步至最新的20%退货率 (假设在5月30日为20%)，这是传统数据更新方式不可能做到的。

![](https://cdn.nlark.com/yuque/0/2023/png/34333118/1684848853071-c1eb3084-2acf-4288-89ba-9f25db2e123e.png)

### 严谨的流程

下述流程图，即为我刚才提到的我表格的更新流程。

![](https://cdn.nlark.com/yuque/0/2023/png/34333118/1684849358031-ffe8a42d-6110-4fce-be62-5ac40adb6b60.png)

目前将单日的多场直播数据整合到「单日汇总」的「单天一行表」仍在建设中，这其中涉及较多较复杂的公式与换算处理。

该操作的意义可参考我的四月第三周报：

-   [https://www.yuque.com/roo/wr/week-3-april-report#WpMCL](https://www.yuque.com/roo/wr/week-3-april-report#WpMCL)

#### 提前预览

如果需要提前预览建设进度，可点击下表右上角的「查看原文」即可全屏查看。

-   由于还在建设中，故目前仅供预览用途并未完成，对于下表的说明，仍在四月第三周报：
-   [https://www.yuque.com/roo/wr/week-3-april-report#WpMCL](https://www.yuque.com/roo/wr/week-3-april-report#WpMCL)

此处为语雀内容卡片，点击链接查看：[https://www.yuque.com/roo/ld/comprehensive](https://www.yuque.com/roo/ld/comprehensive)

### 顶尖的屏控

正在设计一个自动化屏控，由 ChatGPT 根据当前实时的直播内容，与主播进行互动的方案。

目前方案的特性包含：

-   多个不同的角色身份，根据主播实时话术与直播内容，与主播进行互动
-   多个不同阶段的客户生命周期身份，根据主播实时话术与直播内容，与主播进行互动
-   一对 N，一个控制台，可以控制无上限数量的身份
-   实时调整，可由操作人员实时调整当前的互动方案
-   账户管理，包括自动化养号 (防检测) 和设计合理的更名周期
-   实时内容，根据主播实时话术与直播内容，进行互动

![](https://cdn.nlark.com/yuque/0/2023/png/34333118/1684850350266-8faef6b1-5276-4d1b-a7a0-90a397574964.png)

这个方案其中每单独一项特性，都是行业内最顶尖的技术，而将它们整合起来，将发挥极大的实用价值与商业价值。

该方案的意义可参考我的五月第一周报：：

-   [📎0506-张涛-中控周报.pdf](https://www.yuque.com/attachments/yuque/0/2023/pdf/34333118/1684851356363-f2de2d0a-8d6a-455d-97a2-479c8f263949.pdf)

我先简单介绍一下我最近和之前做过的一些成果

#### 一对N、实时调整

下述视频，就是我一年前做过的一个一对N，并且可实时调整的屏控系统。(视频播放方式采用哔哩哔哩嵌入)

-   下述视频可从 13分半 左右看起

[https://player.bilibili.com/player.html?bvid=BV1Ko4y1V7kg&autoplay=0](https://player.bilibili.com/player.html?bvid=BV1Ko4y1V7kg&autoplay=0)

上述视频演示我之前做的屏控系统，使得一台手机一个人，就可以控制最高两万人 (平均五千人) 在线直播间的公屏走向。

-   之前我所在的直播间，为了保证公屏粉丝互动的积极性，采取的与粉丝承诺的过款方式是根据公屏哪个款扣字多，就过哪个款
-   而为了在该过款方式下，仍能保证过款是直播团队可控的，所以诞生了「屏控」这一工作内容

#### 话术框架

而下图所示的话术框架，就是配合上述我一年前做的屏控系统来使用的，下述话术的编撰时间是两年前。用 XMind 编写的，以至于现在都无法用最新版的 XMind 打开。故而采取了截图的形式进行展示。

![](https://cdn.nlark.com/yuque/0/2023/png/34333118/1684852830874-11584979-82e5-4e99-b6e0-26a463ab2532.png)![](https://cdn.nlark.com/yuque/0/2023/png/34333118/1684852886116-177b06c3-243b-4be8-a1ee-5148cf6344ff.png)

上述话术框架的附件版本为：[📎水军话术48.xmind](https://www.yuque.com/attachments/yuque/0/2023/xmind/34333118/1684998324072-2a236b6d-c2d0-4837-80ef-29eb6df06b39.xmind)

(注：由于编撰时间已过许久，用最新版的 XMind 打开时，格式会有丢失)

#### 实时话术、内容

##### 实时话术

如下图中间所示的实时主播话术窗口，该窗口实时记录了主播的话术

1.  为后续的 ChatGPT 根据主播的实时话术，与主播进行互动打下了基础

![](https://cdn.nlark.com/yuque/0/2023/png/34333118/1684998521829-4e47c1a4-60b6-4d59-bdad-3875379dc351.png)

2.  根据主播的实时话术，我已经建立了一套系统，可以在 0.5 秒内分析出主播现在是在讲什么产品，并再在 0.5 内进行主动切换主播讲的产品

-   如下图所示，在该系统下，中控只要设计好该系统的关键词，即可

-   这样的创新，将中控的部分工作内容，由重复劳动转换为了脑力劳动
-   (下图有一些重复或令人疑惑的项，是由于为了适配某些设置而需要的，随着不断优化将被更新和清除，使之更简洁)

-   该系统的点击速度超越了任何一个中控，是行业内最快的；点击精准也是极高的 (实际上点错了也无所谓，系统根据实时话术非常快速的定位到正确的讲解链接)

![](https://cdn.nlark.com/yuque/0/2023/jpeg/34333118/1684999207415-4108631b-fb45-4627-a4a9-162255fa728f.jpeg)

![](https://cdn.nlark.com/yuque/0/2023/jpeg/34333118/1684999198852-e1d215b8-318a-4468-b9e1-2488e32160b3.jpeg)

3.  由于上述系统的特性，它做的比任何一个中控来点击讲解都要好，并且由于它是程序化的，可拓展空间是极大的，比如说它将讲解日志记录下来，对比两天不同产品的讲解频率，可以从数据的层面得出讲解什么产品是好的

-   这是抖音官方提供的讲解大屏图做不到的
-   实际上该程序的点击讲解是根据实时的直播内容极快的进行点击和响应的，由它点击讲解，抖音官方生成的讲解图，实际上得出的大屏讲解是比人类操作要更精准的和更具有分析价值的

4.  上述讲解链接的自动得出，也将为 ChatGPT 的输入提供参数
5.  这类非常强大的系统，随着直播团队的壮大，它是会越来越强的；因为越大的直播团队，数据就越稳定，数据量就越多

-   数据稳定，使得干扰项少，得出的数据分析结果将更准确
-   数据量多，人类很难把握，而我设计的系统并不会——它能精准把握

6.  该「实时主播话术窗口」采用的方法是钉钉提供的，有些时候该窗口会卡住，而我添加了一个功能使之能够被及时发现

![](https://cdn.nlark.com/yuque/0/2023/png/34333118/1684998521823-f4c5bbd2-4ea2-44f3-9787-1062f58aa3dc.png)

#### 账户管理

##### 养号

抖音官方是会检测「水军账号」的，而我有一套成熟的方案来应对。

被判定为水军账号的账号，在直播间扣字时，是会有概率不显示的；对于这一实际情况，我想「谢杭峰科学护肤」号的团队成员应该清楚，因为这一账号的运营似乎是有「屏控」的工作内容。

##### 进入直播间

搜索流量高对于一个直播账号来说，是不好的。所以在我之前的团队中，会要求采用「分享」的方式进入直播间，以剔除 (降低)「搜索流量」。

##### 粉丝管理

这一条我们团队不一定能用，但是也可以说说。

我之前团队是不希望有男性关注者的，所以对于会从观众列表将男性关注者进行拉黑操作，以使得账号的标签更为精准。

-   由于我们的关注者有数十万，这不可能由人工完成，我就写了一个自动拉黑男性关注者的程序
-   我自己的抖音账号的性别设置为女性，也是由于上述原因

不过我们的账号是品牌账号，应该是不能用这样的方法来操作。

### 往期周报

此处为语雀内容卡片，点击链接查看：[https://www.yuque.com/roo/wr2/historical-weekly-reports](https://www.yuque.com/roo/wr2/historical-weekly-reports)